```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRIGO Finance Copilot</title>
    <style>
        :root {
            --primary-bg: #f4f5f7;
            --secondary-bg: #ffffff;
            --border-color: #e0e0e0;
            --text-primary: #333333;
            --text-secondary: #777777;
            --accent-teal: #00A898;
            --negative-red: #d32f2f;
            --shadow-light: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        /* Base & Utilities */
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; margin: 0; background-color: var(--primary-bg); color: var(--text-primary); line-height: 1.6; }
        .container { max-width: 1400px; margin: 0 auto; padding: 1rem; }
        .flex { display: flex; }
        .flex-grow { flex-grow: 1; }
        .flex-col { flex-direction: column; }
        .gap-4 { gap: 1rem; }
        .rounded-lg { border-radius: 0.5rem; }
        .shadow-md { box-shadow: var(--shadow-light); }
        .p-4 { padding: 1rem; }
        .bg-white { background-color: var(--secondary-bg); }
        .text-sm { font-size: 0.875rem; }
        .text-xs { font-size: 0.75rem; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .font-semibold { font-weight: 600; }
        .font-mono { font-family: 'SF Mono', 'Menlo', 'Monaco', 'Courier New', monospace; }
        .mb-4 { margin-bottom: 1rem; }
        .mt-4 { margin-top: 1rem; }
        .w-full { width: 100%; }
        .sticky-header { position: sticky; top: 0; z-index: 100; }
        .badge { padding: 0.25rem 0.5rem; border-radius: 9999px; font-weight: 600; }
        .badge-negative { background-color: rgba(211, 47, 47, 0.1); color: var(--negative-red); }
        .button { padding: 12px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; border: 1px solid transparent; text-align: center; font-size: 1rem; display: inline-flex; justify-content: center; align-items: center; min-width: 44px; min-height: 44px; }
        .button:focus, .button-icon:focus { outline: 2px solid var(--accent-teal); outline-offset: 2px; }
        .button-primary { background-color: var(--accent-teal); color: #fff; }
        .button-secondary { background-color: #fff; color: var(--accent-teal); border-color: var(--accent-teal); }
        .button:disabled { opacity: 0.5; cursor: not-allowed; }
        .input, select, textarea { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color); background-color: #fff; font-size: 1rem; }
        .input:focus, select:focus, textarea:focus { outline: none; border-color: var(--accent-teal); box-shadow: 0 0 0 2px rgba(0, 168, 152, 0.2); }
        textarea { min-height: 120px; resize: vertical; }
        .toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background-color: #333; color: #fff; padding: 12px 24px; border-radius: 8px; z-index: 1000; opacity: 0; transition: opacity 0.3s ease-in-out; }
        .toast.show { opacity: 1; }
        .list-item { display: flex; align-items: center; padding: 0.75rem; border-bottom: 1px solid var(--border-color); cursor: pointer; }
        .list-item:last-child { border-bottom: none; }
        .list-item:hover { background-color: #f0f0f0; }
        .highlight { background-color: rgba(0, 168, 152, 0.2); }
        .chat-message { padding: 1rem; margin-bottom: 1rem; border-radius: 12px; }
        .chat-message.ai { background-color: #e6f7ff; color: #004085; }
        .chat-message.user { background-color: #e2e3e5; text-align: right; }
        .citation { color: var(--text-secondary); font-size: 0.8em; margin-top: 0.5rem; display: block; }
        .dot { height: 10px; width: 10px; border-radius: 50%; display: inline-block; margin-right: 0.5rem; }
        .dot-green { background-color: #4CAF50; }
        .dot-red { background-color: var(--negative-red); }

        /* Layout */
        header { background-color: #fff; border-bottom: 1px solid var(--border-color); padding: 1rem; display: flex; justify-content: space-between; align-items: center; gap: 1rem; flex-wrap: wrap; }
        .header-actions { display: flex; gap: 0.5rem; align-items: center; }
        main { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
        
        .kpi-card { border-left: 5px solid; padding: 1rem; }
        .kpi-card-positive { border-color: #4CAF50; }
        .kpi-card-negative { border-color: var(--negative-red); }
        .kpi-card-neutral { border-color: #ff9800; }
        .kpi-label { text-transform: uppercase; font-weight: bold; }
        .kpi-value { font-size: 2rem; font-weight: 300; }
        .kpi-vs { color: var(--text-secondary); }

        .chat-window { display: flex; flex-direction: column; height: 100%; }
        .chat-log { flex-grow: 1; overflow-y: auto; padding: 1rem; }
        .chat-input-container { padding: 1rem; border-top: 1px solid var(--border-color); display: flex; gap: 0.5rem; }
        .chat-quick-chips { display: flex; flex-wrap: wrap; gap: 0.5rem; padding: 0 1rem; }
        .chip { background-color: #f0f2f5; border-radius: 9999px; padding: 0.5rem 1rem; font-size: 0.875rem; cursor: pointer; }

        /* Responsive */
        @media (min-width: 640px) {
            .sm-grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .sm-col-span-1 { grid-column: span 1 / span 1; }
            .header-actions { flex-wrap: nowrap; }
        }
        @media (min-width: 1024px) {
            main { grid-template-columns: 1.2fr 2.5fr 1.5fr; }
            .sticky-header { position: relative; }
        }
    </style>
</head>
<body>
    <header class="sticky-header">
        <h1 class="text-xl font-semibold">TRIGO Finance Copilot</h1>
        <div class="flex-grow"></div>
        <div class="header-actions">
            <select id="countrySelect" aria-label="Select Country">
                <option value="JP">Japan</option>
                <option value="US">USA</option>
            </select>
            <select id="monthSelect" aria-label="Select Month">
                <option value="Aug">August 2025</option>
                <option value="Sep">September 2025</option>
            </select>
            <button id="generateBtn" class="button button-primary">Generate Draft</button>
            <button id="approveBtn" class="button button-secondary">Approve & Export</button>
            <button id="exportPptBtn" class="button button-secondary" title="Export to PowerPoint">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15.5V8.5H9v9zm3 0V8.5h-2v9h2zm-4.75-9.25a.75.75 0 010-1.5h.75a.75.75 0 010 1.5h-.75zM15 15.5V8.5h-2v7h2z"/></svg>
            </button>
            <button id="exportDocBtn" class="button button-secondary" title="Export to Word">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15h2v-2h-2v2zm0-4h2V7h-2v6z"/></svg>
            </button>
        </div>
    </header>

    <main class="container gap-4">
        <aside class="flex-col gap-4">
            <div class="p-4 bg-white rounded-lg shadow-md">
                <h2 class="text-lg font-semibold mb-4">KPI Deltas</h2>
                <div id="kpiCards" class="grid gap-4 sm-grid-cols-2">
                    </div>
            </div>

            <div class="p-4 bg-white rounded-lg shadow-md">
                <h2 class="text-lg font-semibold mb-4">Top Drivers</h2>
                <ul id="topDrivers" class="text-sm">
                    </ul>
                <div id="waterfall" class="mt-4 p-4 text-center text-secondary" style="border: 1px dashed var(--border-color);">
                    Mini waterfall chart placeholder
                </div>
            </div>
        </aside>

        <section class="flex-col gap-4">
            <div class="p-4 bg-white rounded-lg shadow-md flex flex-col gap-2">
                <h2 class="text-lg font-semibold">Structured Commentary</h2>
                <div id="alerts" class="mb-2">
                    </div>
                <div>
                    <h3 class="font-semibold text-sm">Highlights</h3>
                    <textarea id="highlights" class="w-full"></textarea>
                    <span class="text-xs text-secondary">Word count: <span id="highlights-wc">0</span></span>
                </div>
                <div>
                    <h3 class="font-semibold text-sm">Causes</h3>
                    <textarea id="causes" class="w-full"></textarea>
                    <span class="text-xs text-secondary">Word count: <span id="causes-wc">0</span></span>
                </div>
                <div>
                    <h3 class="font-semibold text-sm">Actions</h3>
                    <textarea id="actions" class="w-full"></textarea>
                    <span class="text-xs text-secondary">Word count: <span id="actions-wc">0</span></span>
                </div>
                <div>
                    <h3 class="font-semibold text-sm">Outlook</h3>
                    <textarea id="outlook" class="w-full"></textarea>
                    <span class="text-xs text-secondary">Word count: <span id="outlook-wc">0</span></span>
                </div>
            </div>
        </section>

        <aside class="flex-col gap-4">
            <div class="p-4 bg-white rounded-lg shadow-md flex-grow flex flex-col" style="height: 50vh;">
                <h2 class="text-lg font-semibold mb-2">Q&A Chat</h2>
                <div class="chat-quick-chips">
                    <span class="chip">Why is GM down?</span>
                    <span class="chip">What is the action plan?</span>
                    <span class="chip">Who is the owner?</span>
                </div>
                <div id="chatLog" class="chat-log flex-grow" role="log" aria-live="polite" aria-label="Chat history">
                    </div>
                <div class="chat-input-container">
                    <input type="text" id="chatInput" placeholder="Ask about the report..." class="flex-grow">
                    <button id="chatSend" class="button button-primary" aria-label="Send message">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
                    </button>
                </div>
            </div>

            <div class="p-4 bg-white rounded-lg shadow-md flex-col flex-grow">
                <h2 class="text-lg font-semibold mb-2">Evidence</h2>
                <ul id="evidenceList" class="text-sm">
                    </ul>
            </div>
        </aside>
    </main>
    
    <div id="toast" class="toast" role="status" aria-live="polite"></div>

    <script>
        const KPI_ROWS = [
            { metric: "REV", delta: -180000, vs: "BUD", sites: ["JP_TOKYO"], note: "Lower Hitachi hrs (-192)" },
            { metric: "GM_pts", delta: -2.1, vs: "FCT", sites: ["JP_TOKYO", "JP_OSAKA"], note: "Training +â‚¬9k, chargeback +â‚¬11k" },
            { metric: "INDIRECT", delta: +22000, vs: "FCT", sites: ["HQ"], note: "O365 one-off +â‚¬1k; overhead drift" }
        ];
        const ALIASES = {
            "JP_TOKYO": { "site": "Tokyo", "customer": "Mitsubishi Fuso", "activity": "Inspection" }
        };
        const TRANSCRIPTS = [
            { id: "T-0924-03", country: "Japan", ts: "2023-09-28 10:04", text: "Hitachi hours -192 vs FCT; plan to recover in Oct." },
            { id: "T-0924-07", country: "Japan", ts: "2023-09-28 10:22", text: "Training (Ogawa) +â‚¬9k and Beijing HHT Rail chargeback +â‚¬11k." },
            { id: "T-0924-11", country: "Japan", ts: "2023-09-28 10:41", text: "Action: tighten chargeback approvals; owner JP CFO; due Oct-15." }
        ];

        // Utility functions
        function formatNumber(num) {
            if (Math.abs(num) >= 1000) {
                return (num / 1000).toFixed(1) + 'k';
            }
            return num;
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function updateWordCounts() {
            ['highlights', 'causes', 'actions', 'outlook'].forEach(id => {
                const textarea = document.getElementById(id);
                const countSpan = document.getElementById(`${id}-wc`);
                if (textarea && countSpan) {
                    const text = textarea.value.trim();
                    const wordCount = text ? text.split(/\s+/).length : 0;
                    countSpan.textContent = wordCount;
                }
            });
        }

        // Render functions
        function renderKpiCards() {
            const container = document.getElementById('kpiCards');
            container.innerHTML = KPI_ROWS.map(kpi => {
                const isPositive = kpi.delta > 0;
                const sign = isPositive ? '+' : '';
                const deltaClass = kpi.delta > 0 ? 'kpi-card-positive' : (kpi.delta < 0 ? 'kpi-card-negative' : 'kpi-card-neutral');
                return `
                    <div class="kpi-card rounded-lg shadow-md bg-white ${deltaClass}">
                        <div class="kpi-label text-sm">${kpi.metric}</div>
                        <div class="kpi-value">${sign}â‚¬${Math.abs(formatNumber(kpi.delta))}</div>
                        <div class="kpi-vs text-xs">vs. ${kpi.vs}</div>
                    </div>
                `;
            }).join('');
        }

        function renderTopDrivers() {
            const container = document.getElementById('topDrivers');
            container.innerHTML = KPI_ROWS.map(kpi => {
                const alias = kpi.sites.length > 0 && ALIASES[kpi.sites[0]] ? ALIASES[kpi.sites[0]].customer : '';
                return `<li>${kpi.note} at ${alias}</li>`;
            }).join('');
        }

        function renderEvidence() {
            const container = document.getElementById('evidenceList');
            let html = '<ul class="list-none m-0 p-0">';
            
            KPI_ROWS.forEach(kpi => {
                html += `
                    <li class="list-item" data-id="${kpi.metric}">
                        <div class="flex-grow">
                            <div class="text-sm font-semibold">${kpi.metric}</div>
                            <div class="text-xs text-secondary">${kpi.note}</div>
                        </div>
                        <svg class="w-4 h-4 text-secondary" fill="currentColor" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                    </li>
                `;
            });

            TRANSCRIPTS.forEach(t => {
                html += `
                    <li class="list-item" data-id="${t.id}">
                        <div class="flex-grow">
                            <div class="font-mono text-xs">${t.id}</div>
                            <div class="text-sm text-secondary">${t.text.substring(0, 50)}...</div>
                        </div>
                        <svg class="w-4 h-4 text-secondary" fill="currentColor" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                    </li>
                `;
            });

            html += '</ul>';
            container.innerHTML = html;
        }

        function highlightCommentary(id) {
            const textareas = document.querySelectorAll('#highlights, #causes, #actions, #outlook');
            textareas.forEach(ta => {
                const content = ta.value;
                ta.value = content.split(' ').map(word => {
                    const cleanWord = word.replace(/[.,;]$/, '');
                    if (cleanWord === `[${id}]`) {
                        return `<span class="highlight">${word}</span>`;
                    }
                    return word;
                }).join(' ');
            });
            // Simple approach, full highlight logic would be more complex
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            renderKpiCards();
            renderTopDrivers();
            renderEvidence();

            document.getElementById('generateBtn').addEventListener('click', () => {
                const highlightsText = `GM ${KPI_ROWS[1].delta} pts vs ${KPI_ROWS[1].vs}; REV ${KPI_ROWS[0].delta}k vs ${KPI_ROWS[0].vs}; INDIRECT ${KPI_ROWS[2].delta}k vs ${KPI_ROWS[2].vs}.`;
                const causesText = `Fewer inspection hours at ${ALIASES["JP_TOKYO"].customer} (${TRANSCRIPTS[0].text.split(';')[0]}) [${TRANSCRIPTS[0].id}].\nTraining +â‚¬9k and chargeback +â‚¬11k dilute margin [${TRANSCRIPTS[1].id}].`;
                const actionsText = `Tighten chargeback approvals (${TRANSCRIPTS[2].text.substring(TRANSCRIPTS[2].text.indexOf('owner'), TRANSCRIPTS[2].text.indexOf('due')).trim()}; due Oct-15) [${TRANSCRIPTS[2].id}].`;
                const outlookText = `Sep record lag shifts to Oct; GM expected to normalize (~20â€“21%) if hours restored.`;

                document.getElementById('highlights').value = highlightsText;
                document.getElementById('causes').value = causesText;
                document.getElementById('actions').value = actionsText;
                document.getElementById('outlook').value = outlookText;
                
                updateWordCounts();
                checkRedFlags();
            });

            document.getElementById('chatSend').addEventListener('click', () => {
                const input = document.getElementById('chatInput');
                const chatLog = document.getElementById('chatLog');
                const userMessage = input.value.trim();

                if (userMessage) {
                    const userDiv = document.createElement('div');
                    userDiv.classList.add('chat-message', 'user');
                    userDiv.textContent = userMessage;
                    chatLog.appendChild(userDiv);
                    input.value = '';

                    setTimeout(() => {
                        const aiDiv = document.createElement('div');
                        aiDiv.classList.add('chat-message', 'ai');
                        aiDiv.innerHTML = `
                            The biggest driver of the GM delta is from training and chargeback costs, as noted in the source data.
                            <br><span class="citation">Source: KPI Row "GM_pts", Transcript ${TRANSCRIPTS[1].id}</span>
                        `;
                        chatLog.appendChild(aiDiv);
                        chatLog.scrollTop = chatLog.scrollHeight;
                    }, 300);
                }
            });

            document.querySelectorAll('.chip').forEach(chip => {
                chip.addEventListener('click', () => {
                    document.getElementById('chatInput').value = chip.textContent;
                });
            });

            document.getElementById('evidenceList').addEventListener('click', (event) => {
                const listItem = event.target.closest('.list-item');
                if (listItem) {
                    const id = listItem.dataset.id;
                    const textareas = document.querySelectorAll('#highlights, #causes, #actions, #outlook');
                    textareas.forEach(ta => {
                        const content = ta.value;
                        const regex = new RegExp(`\\[${id}\\]`, 'g');
                        const newContent = content.replace(regex, `<mark class="highlight">[${id}]</mark>`);
                        ta.innerHTML = newContent;
                    });
                }
            });

            document.getElementById('exportPptBtn').addEventListener('click', () => showToast('Export to PowerPoint simulated.'));
            document.getElementById('exportDocBtn').addEventListener('click', () => showToast('Export to Word simulated.'));

            function checkRedFlags() {
                const alertsDiv = document.getElementById('alerts');
                alertsDiv.innerHTML = '';
                const gmKpi = KPI_ROWS.find(k => k.metric === 'GM_pts');
                const revKpi = KPI_ROWS.find(k => k.metric === 'REV');

                if (gmKpi && Math.abs(gmKpi.delta) >= 5) {
                    alertsDiv.innerHTML += '<span class="badge badge-negative">ðŸš¨ High GM Variance</span> ';
                }
                if (revKpi && revKpi.delta <= -100000) {
                    alertsDiv.innerHTML += '<span class="badge badge-negative">ðŸš¨ Significant Revenue Drop</span>';
                }
            }
        });
    </script>
</body>
</html>
```